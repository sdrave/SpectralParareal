\documentclass[tikz, border=0cm]{standalone}
\input{shared_preamble}

\begin{document}
    \begin{tikzpicture}
        \begin{groupplot}[
                group style={ 
                    group size=2 by 1,
                    horizontal sep=1.5cm,
                    vertical sep=1.5cm,
                },
                ymode=log,
                width=0.5\textwidth,
                xmin=0,
                xtick distance=4,
                xmax=25,
                ytick distance=10^2,
                ymax=10^3,
                ymin=10^(-16),
                ytick distance=1e3,
                xlabel=$k$,
                minor x tick num=3,
            ]
            \nextgroupplot[
                title={randomized SVD ($p=0$)},
                legend to name=first,
                legend style={legend columns=8},
                ylabel=$\ell^2$-error,
            ]
            \foreach \i in {0,1,...,3} {
                \addplot table[x expr=\coordindex, y index=\i]{../data/ex4_rsvd_p0q0_s25_max_errs.dat};
                \addlegendentryexpanded{$R=\i$}
            }
            \addplot[black, dashed, semithick]
                table[x expr=\coordindex, y index=0]{../data/ex4_euler_s25_max_errs.dat};
            \addlegendentryexpanded{Euler}
            \coordinate (c1) at (rel axis cs:0,1);
            \nextgroupplot[
                title={randomized RSVD ($p=1$)},
            ]
            \foreach \i in {0,1,...,3} {
                \addplot table[x expr=\coordindex, y index=\i]{../data/ex4_rsvd_p1q0_s25_max_errs.dat};
            }
            \addplot[black, dashed]
                table[x expr=\coordindex, y index=0]{../data/ex4_euler_s25_max_errs.dat};
            \coordinate (c2) at (rel axis cs:1,1);
        \end{groupplot}
        \coordinate (c3) at ($(c1)!.5!(c2)$);
            \node[below] at (c3 |- current bounding box.south)
          {\pgfplotslegendfromname{first}};
    \end{tikzpicture}
\end{document}
