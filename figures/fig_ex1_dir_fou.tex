\documentclass[tikz, border=0cm]{standalone}
\input{shared_preamble}

\begin{document}
    \begin{tikzpicture}
        \begin{groupplot}[
                group style={ 
                    group size=2 by 2,
                    horizontal sep=1.5cm,
                    vertical sep=1.5cm,
                },
                ymode=log,
                ymax=1e2,
                ytick distance=1e4,
                xtick distance=0.25,
                width=0.5\textwidth,
            ]
            \nextgroupplot[
                title={$\operatorname{rank}{G_n} = 2$},
                xlabel=$t$,
                ylabel=$\ell^2$-error,
                legend to name=first,
                legend style={legend columns=10}
            ]
            \addlegendimage{empty legend}
            \addlegendentry{$k=$\ }
            \foreach \i in {1,2,...,9} {
                \addplot+[mark=] table[x index=0, y index=\i]{../data/ex1_dir_fou_s10_errs_k2.dat};
                \pgfmathparse{int(\i - 1)}
                \addlegendentryexpanded{ \pgfmathresult }
            }
            \coordinate (c1) at (rel axis cs:0,1);
            \nextgroupplot[
                title={$\operatorname{rank}{G_n}  = 3$},
                xlabel=$t$,
            ]
            \foreach \i in {1,2,...,9} {
                \addplot+[mark=] table[each nth point={1}, x index=0, y index=\i]{../data/ex1_dir_fou_s10_errs_k3.dat};
            }
            \coordinate (c2) at (rel axis cs:1,1);
        \end{groupplot}
        \coordinate (c3) at ($(c1)!.5!(c2)$);
        \node[below] at (c3 |- current bounding box.south) {\pgfplotslegendfromname{first}};
    \end{tikzpicture}
\end{document}
